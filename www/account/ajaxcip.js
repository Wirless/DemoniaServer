var g_Event;var g_LastHash;var g_AjaxConfig;$(document).ready(function(){var b=new AjaxHistory();$("body").live("mouseover",function(f){g_Event=f.originalEvent});$("body").bind("keydown",function(f){g_Event=f.originalEvent});jQuery.ajaxSetup({beforeSend:function(f){},cache:false});var c={Target:null,Error:null};if(window.g_AjaxConfig===undefined){g_AjaxConfig=c}else{for(var a in c){if(g_AjaxConfig[a]===undefined){g_AjaxConfig[a]=c[a]}}}if(window.g_AjaxDefaultTarget===undefined){var d=null}if(window.g_UseAjaxAttributes===undefined){var e=false}$("[ajaxcip=true], [ajaxcip_href]").live("click.AjaxCip",function(g){var f=new AjaxCipRequest(g.target);f.m_Send();g.preventDefault()});$("a[ajaxcip=true]").live("mousedown.AjaxCip",function(f){if(f.which==2){f.target.href+=location.hash}});g_LastHash=location.hash;setInterval(function(){if(location.hash!=g_LastHash){g_LastHash=location.hash;b.handleHistory()}},1000)});function SendAjaxCip(a,c){var b=new AjaxCipRequest(g_Event.target,a,c);b.m_Send()}function AjaxCipParameters(){this.m_Parameters={}}AjaxCipParameters.prototype={m_InitializeParameters:function(){this.m_Parameters.DataType=null;this.m_Parameters.Target=null;this.m_Parameters.UpdateType=0;this.m_Parameters.CreateHistoryEntry=null},m_SetParameters:function(b){if(b!==undefined){if(typeof(b)=="object"){for(var a in b){if(typeof(b[a])=="string"||typeof(b[a])=="number"||typeof(b[a])=="boolean"){switch(a){case"DataType":case"Target":case"UpdateType":case"CreateHistoryEntry":this.m_Parameters[a]=b[a];break}}}}else{if(typeof(a_Options)=="string"){}}}}};function AjaxCipRequest(c,a,b){this.m_Element=c;this.m_InitializeOptions();if($(this.m_Element).attr("type")=="submit"){this.m_InitializeByForm()}this.m_Options.Href=$(this.m_Element).attr("href");this.m_InitializeParameters();this.m_SetOptions({Error:g_AjaxConfig.Error});this.m_SetOptions(this.m_GetAttributeOptions());this.m_SetOptions(b);this.m_SetParameters({Target:g_AjaxConfig.Target});this.m_SetParameters(this.m_GetAttributeParameters());if(a!==undefined){this.m_SetParameters(a)}}AjaxCipRequest.prototype={m_AttributeLabels:{Parameters:{ajaxcip_datatype:"DataType",ajaxcip_target:"Target",ajaxcip_updatetype:"UpdateType",ajaxcip_createhistoryentry:"CreateHistoryEntry"},Options:{ajaxcip_link:"Link",ajaxcip_method:"Method",ajaxcip_href:"Href",ajaxcip_postdata:"PostData",ajaxcip_error:"Error"}},m_Options:{},m_InitializeOptions:function(){this.m_Options.Link=null;this.m_Options.Method="GET";this.m_Options.Href="";this.m_Options.PostData=""},m_InitializeByForm:function(){if(this.m_Element.form){this.m_Form=this.m_Element.form}else{if($(this.m_Element).parents("form").length>0){this.m_Form=$(this.m_Element).parents("form")[0]}else{return false}}this.m_SetOptions({Method:this.m_Form.method.toUpperCase(),Href:$(this.m_Form).attr("action"),PostData:$(this.m_Form).serialize()})},m_GetAttributeParameters:function(){var c=new Object();for(var a in this.m_AttributeLabels.Parameters){var b=$(this.m_Element).attr(a);if(b!==undefined){c[this.m_AttributeLabels.Parameters[a]]=b}}return c},m_GetAttributeOptions:function(){var b=new Object();for(var a in this.m_AttributeLabels.Options){var c=$(this.m_Element).attr(a);if(c!==undefined){b[this.m_AttributeLabels.Options[a]]=c}}return b},m_SetOptions:function(b){if(b!==undefined){if(typeof(b)=="object"){for(var a in b){if(typeof(b[a])=="string"||typeof(b[a])=="number"||typeof(b[a])=="boolean"){switch(a){case"Link":case"Method":case"Href":case"PostData":case"Error":this.m_Options[a]=b[a];break}}}}else{if(typeof(b)=="string"){}}}},m_Send:function(){var a={url:this.m_Options.Href,success:function(e,b,d){var c=new AjaxCipResponse(this,d,b);c.m_HandleResponse()},error:function(d,b,c){if(typeof(this.m_Options.Error)=="string"&&typeof(window[this.m_Options.Error])=="function"){window[this.m_Options.Error](d,b,c)}},dataFilter:function(c,b){return c},context:this,type:this.m_Options.Method};if(this.m_Options.Method=="POST"){a.data=this.m_Options.PostData}jQuery.ajax(a)}};Extend(AjaxCipRequest,AjaxCipParameters);var AjaxCipResponse=function(a,b,d){this.m_Request=a;this.m_XHR=b;this.m_TextStatus=d;this.m_ResponseType=this.m_GetResponseHeader("X-Ajax-Cip-Response-Type");var c=this.m_GetResponseHeader("X-Ajax-Cip-Requests");this.m_Requests=(c!=null)?c.split("#"):null;this.m_Data=this.m_XHR.responseText;this.m_InitializeParameters();this.m_SetParameters(this.m_Request.m_Parameters)};AjaxCipResponse.prototype={m_HandleResponse:function(){if(this.m_ResponseType=="Raw"||this.m_ResponseType==null){this.m_SetParameters({DataType:this.m_GetResponseHeader("X-Ajax-Cip-Data-Type"),Target:this.m_GetResponseHeader("X-Ajax-Cip-Target"),UpdateType:this.m_GetResponseHeader("X-Ajax-Cip-Update-Type"),CreateHistoryEntry:this.m_GetResponseHeader("X-Ajax-Cip-Create-HistoryEntry")})}else{if(this.m_ResponseType=="Single"){if(typeof(this.m_Data)=="string"){var a=jQuery.parseJSON(this.m_Data)}else{var a=this.m_Data}this.m_SetParameters(a);this.m_Data=a.Data}else{if(this.m_ResponseType=="Container"){this.m_Container=jQuery.parseJSON(this.m_Data)}}}if(this.m_ResponseType=="Container"){for(var b in this.m_Container.AjaxObjects){var c=new AjaxCipResponse(this.m_Request,this.m_XHR,this.m_TextStatus);c.m_Requests=null;c.m_ResponseType="Single";c.m_Data=this.m_Container.AjaxObjects[b];c.m_HandleResponse()}}else{if(this.m_Data!=null){switch(this.m_Parameters.DataType){case"HTML":case null:if(this.m_Parameters.Target!==null){this.m_HandleHTML()}else{}break;case"Attributes":if(this.m_Parameters.Target!==null){this.m_HandleAttributes()}else{}break}}}},m_HandleHTML:function(){switch(parseInt(this.m_Parameters.UpdateType)){case 0:case null:$(this.m_Parameters.Target).html(this.m_Data);break;case 1:$(this.m_Parameters.Target).replaceWith(this.m_Data);break;case 2:$(this.m_Parameters.Target).append(this.m_Data);break;case 3:$(this.m_Parameters.Target).after(this.m_Data);break;case 4:$(this.m_Parameters.Target).prepend(this.m_Data);break;case 5:$(this.m_Parameters.Target).before(this.m_Data);break}},m_HandleAttributes:function(){var a=new Object();if(typeof(this.m_Data)=="object"){a=jQuery.parseJSON(this.m_Data)}else{if(typeof(this.m_Data)=="string"){var d=decodeURIComponent(this.m_Data).split("&");for(var c in d){var b=d[c].split("=");a[b[0]]=b[1]}}}$(this.m_Parameters.Target).attr(a)},m_GetResponseHeader:function(c){var b=this.m_XHR.getAllResponseHeaders();if(b.search(new RegExp(c))===-1){return null}var a=this.m_XHR.getResponseHeader(c);return a}};Extend(AjaxCipResponse,AjaxCipParameters);function MyGetResponseHeader(c){var b=this.getAllResponseHeaders();if(b.search(new RegExp(c))===-1){return null}var a=this.oldGetResponseHeader(c);return a}var AjaxHistory=function(){if(AjaxHistory.instance!==undefined){return AjaxHistory.instance}this.History=this.getHistoryAssoc();AjaxHistory.instance=this};AjaxHistory.prototype.addHistoryEntry=function(a){if(this.History[a]){delete this.History[a]}this.History[a]=$("#"+a);this.refreshHistory()};AjaxHistory.prototype.handleHistory=function(){for(var a in this.History){$(this.History[a]).click()}};AjaxHistory.prototype.getHistoryAssoc=function(){var c=location.hash.split("#");var b=new Object();for(var a in c){if(c[a]!=""){b[c[a]]=$("#"+c[a])}}return b};AjaxHistory.prototype.refreshHistory=function(){this.checkHistory();var b="";for(var a in this.History){b+="#"+a}location.hash=b};AjaxHistory.prototype.checkHistory=function(){for(var a in this.History){if($("#"+a).length==0){delete this.History[a]}}};function Extend(g,f){if(f.prototype){var b=new f()}else{var b=f}for(var a in b){try{if(g.prototype){g.prototype[a]=b[a]}else{g[a]=b[a]}}catch(d){var c=d}}};